const a0_0x2b66e4=a0_0xb8bf;(function(_0x4ec887,_0x21aae7){const _0x2c5327=a0_0xb8bf,_0x164eef=_0x4ec887();while(!![]){try{const _0x4262c8=-parseInt(_0x2c5327(0xa3))/0x1*(-parseInt(_0x2c5327(0xdc))/0x2)+parseInt(_0x2c5327(0xd5))/0x3+-parseInt(_0x2c5327(0xbe))/0x4+parseInt(_0x2c5327(0x100))/0x5+parseInt(_0x2c5327(0xe7))/0x6*(-parseInt(_0x2c5327(0x10c))/0x7)+-parseInt(_0x2c5327(0x11e))/0x8*(-parseInt(_0x2c5327(0xfd))/0x9)+-parseInt(_0x2c5327(0xfc))/0xa;if(_0x4262c8===_0x21aae7)break;else _0x164eef['push'](_0x164eef['shift']());}catch(_0x2782e0){_0x164eef['push'](_0x164eef['shift']());}}}(a0_0x2b0b,0x9370c));const {Lipana}=require('@lipana/sdk');function a0_0x2b0b(){const _0x309597=['\x0a\x0aðŸ’³\x20*Payment\x20Summary:*\x0aâ”œâ”€\x20Amount\x20Paid:\x20','wCBAN','\x0aâ”œâ”€\x20Time:\x20','\x0a\x0aðŸ’³\x20*Payment\x20Information:*\x0aâ”œâ”€\x20Phone:\x20','aGNQI','transactionId','\x0aâ”œâ”€\x20Link:\x20','status','Unable\x20to\x20determine\x20customer\x20JID\x20for\x20receipt','eAvFM','pCjHt','FaFct','toLocaleString','FFzAk','VrBIT','UhQqc','ZdKSe','FoGlx','vIKzj','Africa/Nairobi','\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0a','DpBNS','KGyvo','0|3|2|1|4','yUJLj','customerJid','vTgBn','NUBbK','platform','OigOs','error','UOKiI','/=\x20KES\x0aâ”œâ”€\x20Phone\x20Number:\x20','delete','amount','VhIKa','FQsNr','log','wzlSi','lbFcD','uHKOz','qZgay','ZmmAN','\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0aðŸ¤–\x20MADARA\x20UCHIHA\x20Payment\x20System','xalDu','FDYdq','RjpIY','get','OjVLP','WRrxc','â”œâ”€\x20Transaction\x20ID:\x20','nlIUW','gnzwG','Error\x20sending\x20payment\x20verification\x20to\x20admin:','âš ï¸\x20*ACTION:\x20Payment\x20failed\x20-\x20contact\x20customer\x20for\x20resolution*','startsWith','checkoutRequestID','tzzyF','MMEWu','254759424232@s.whatsapp.net','initiateStkPush','Initializing\x20Lipana\x20in\x20','332JPvZlF','SrGMH','âŒ\x20FAILED','failed','pwEDv','Hgdpl','phone','xAhDh','Wxbss','WkAQA','search','\x0aðŸ“¦\x20*Service\x20Details:*\x0aâ”œâ”€\x20Platform:\x20','xlUfy','ecqFl','SiWol','qBTrx','voOFg','IFccy','uoZYH','orderId','Dbabb','lhvFK','timestamp','YQcsd','KoZeb','mpesaReceiptNumber','completedAt','1036376vLeMRg','LIPANA_SECRET_KEY','\x0aâ”œâ”€\x20Date\x20&\x20Time:\x20','QiihB','transactions','MJOJI','OxUEE','254745282166@s.whatsapp.net','eTqzT','\x0aâ”œâ”€\x20Service:\x20','@s.whatsapp.net','WPlDp','receiptNumber','SbrKZ','UKLOb','hZGNu','jXvcU','FmVqB','cxnkd','âœ…\x20SUCCESS','pending','Payment\x20system\x20not\x20configured','toString','535803oHDHBA','GavMX','nusem','rUYyh','UlIbH','â”œâ”€\x20Status:\x20âœ…\x20CONFIRMED\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aâš¡\x20*What\x27s\x20Next?*\x0aYour\x20order\x20is\x20being\x20processed\x20and\x20will\x20be\x20delivered\x20within\x20a\x20few\x20minutes.\x0a\x0aðŸ“ž\x20*Need\x20Help?*\x0aContact\x20support:\x20254745282166\x20or\x20254759424232\x0a\x0aThank\x20you\x20for\x20your\x20business!\x20ðŸ™\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0aðŸ¤–\x20MADARA\x20UCHIHA\x20Bot','qHFSB','5354NNGQNI','YlnUA','\x20mode','qxmEN','qty','vmEQo','EOfRE','LIPANA_SECRET_KEY\x20not\x20set\x20-\x20payment\x20features\x20will\x20not\x20work','sjEwV','pVTjw','Eodwz','14562YFKyzV','EtEOp','tsPCF','message','âœ…\x20*PAYMENT\x20CONFIRMED\x20-\x20RECEIPT*\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aðŸŽ‰\x20*Your\x20payment\x20has\x20been\x20successfully\x20received!*\x0a\x0aðŸ“‹\x20*Receipt\x20Details:*\x0aâ”œâ”€\x20Order\x20ID:\x20','apply','service','sendMessage','NhZcg','SVXsE','hfpdR','aOHyL','LIPANA_ENV','Lipana\x20STK\x20Push\x20Error:','sandbox','254','link','SUCCESS','exports','\x0aâ”œâ”€\x20Transaction\x20Ref:\x20','completed','2965020DSILdA','169011WuwHTU','FALSE\x20âœ—','EnIVv','4845260RVbbdo','zYjfn','EZnjK','jrWvW','Payment\x20initiation\x20failed','Bot\x20socket\x20not\x20available\x20for\x20customer\x20receipt','WPZSF','EwVSq','mpesaRef','âš¡\x20*ACTION:\x20Payment\x20verified\x20-\x20proceed\x20with\x20service\x20delivery*','(((.+)+)+)+$','Failed\x20to\x20send\x20receipt\x20via\x20phone\x20number\x20JID','2800VVHddY','pjRfy','now','replace','toISOString','en-KE','Payment\x20verification\x20error:','aDHsg','YjaJt','env','MCgoc','eWCFv','NscPH','UYsET','ywQAV','kpFaz','oIaHP','âœ…\x20Payment\x20verification\x20sent\x20to\x20admin:\x20','40fdsxfx','success','âœ…\x20Receipt\x20sent\x20to\x20customer:\x20','modVr','warn','N/A','split','â”œâ”€\x20M-PESA\x20Ref:\x20','NBXyG','GzOYo','set','HuoGj'];a0_0x2b0b=function(){return _0x309597;};return a0_0x2b0b();}let lipana=null,botSocket=null;const ADMIN_NUMBERS=[a0_0x2b66e4(0xc5),a0_0x2b66e4(0xa0)];function a0_0xb8bf(_0x5a8735,_0x290d51){_0x5a8735=_0x5a8735-0x71;const _0x1fb54c=a0_0x2b0b();let _0xb39f5b=_0x1fb54c[_0x5a8735];return _0xb39f5b;}function setBotSocket(_0x5d00ba){botSocket=_0x5d00ba;}function initLipana(){const _0xad7208=a0_0x2b66e4,_0x4c1030={'asKqp':_0xad7208(0xd3),'oIaHP':function(_0x162704,_0x433c7e){return _0x162704!==_0x433c7e;},'wCBAN':_0xad7208(0xe5),'nusem':_0xad7208(0x10a),'EZnjK':_0xad7208(0x112),'NhZcg':function(_0x3ff30c,_0x530a6c,_0x33c38a){return _0x3ff30c(_0x530a6c,_0x33c38a);},'oBwPN':function(_0x562010,_0xf38411){return _0x562010!==_0xf38411;},'MCgoc':_0xad7208(0xf0),'VrBIT':_0xad7208(0x134),'UlIbH':_0xad7208(0xe3),'UKLOb':function(_0x584347,_0x5cf03b){return _0x584347===_0x5cf03b;},'Eodwz':_0xad7208(0xf5),'FDYdq':'production'},_0x22fecf=(function(){const _0x628425=_0xad7208,_0x4efb8f={'UYsET':_0x4c1030['asKqp']};if(_0x4c1030[_0x628425(0x11c)](_0x4c1030[_0x628425(0x12b)],_0x4c1030[_0x628425(0x12b)]))throw new _0x5df53d(_0x4efb8f[_0x628425(0x119)]);else{let _0xc59dd9=!![];return function(_0x49bf52,_0x5111f5){const _0x400a54=_0xc59dd9?function(){const _0x58632c=a0_0xb8bf;if(_0x5111f5){const _0x55f014=_0x5111f5[_0x58632c(0xec)](_0x49bf52,arguments);return _0x5111f5=null,_0x55f014;}}:function(){};return _0xc59dd9=![],_0x400a54;};}}()),_0x5d5229=_0x4c1030[_0xad7208(0xef)](_0x22fecf,this,function(){const _0x14db33=_0xad7208;return _0x5d5229[_0x14db33(0xd4)]()[_0x14db33(0xad)](_0x4c1030[_0x14db33(0xd7)])[_0x14db33(0xd4)]()['constructor'](_0x5d5229)[_0x14db33(0xad)](_0x14db33(0x10a));});_0x5d5229();if(!process[_0xad7208(0x115)][_0xad7208(0xbf)])return _0x4c1030['oBwPN'](_0x4c1030[_0xad7208(0x116)],_0x4c1030[_0xad7208(0x73)])?(console[_0xad7208(0x122)](_0x4c1030[_0xad7208(0xd9)]),null):(_0x4d4958['error'](_0x4c1030[_0xad7208(0x102)],_0xcb5e5f),{'success':![],'error':_0x1685f3['message']});const _0x8f1a5e=_0x4c1030[_0xad7208(0xcc)](process[_0xad7208(0x115)][_0xad7208(0xf3)],_0x4c1030[_0xad7208(0xe6)])?_0x4c1030[_0xad7208(0xe6)]:_0x4c1030[_0xad7208(0x92)];return console[_0xad7208(0x8a)](_0xad7208(0xa2)+_0x8f1a5e+_0xad7208(0xde)),new Lipana({'apiKey':process[_0xad7208(0x115)][_0xad7208(0xbf)],'environment':_0x8f1a5e});}lipana=initLipana();const pendingPayments=new Map();async function initiateSTKPush(_0x52c435,_0x55ace6,_0x4a71c6,_0x416823=null,_0xe50d5d=null){const _0x286c0a=a0_0x2b66e4,_0x1246b3={'vmEQo':function(_0x3abde5){return _0x3abde5();},'tsPCF':_0x286c0a(0x10a),'FoGlx':function(_0x24ec68,_0x427462){return _0x24ec68===_0x427462;},'aGNQI':_0x286c0a(0xb3),'OVGOR':function(_0x2eb6eb){return _0x2eb6eb();},'xalDu':'ZbNAf','FmVqB':'Payment\x20system\x20not\x20configured.\x20Contact\x20admin\x20to\x20set\x20up\x20LIPANA_SECRET_KEY','xAhDh':function(_0x237750,_0x5baac6){return _0x237750!==_0x5baac6;},'NBXyG':_0x286c0a(0xd6),'WRrxc':function(_0x27c310,_0x29e733){return _0x27c310+_0x29e733;},'EnIVv':_0x286c0a(0xf6),'vIKzj':function(_0x75bef0,_0xf0aa67){return _0x75bef0!==_0xf0aa67;},'xGsov':_0x286c0a(0x127),'RjpIY':_0x286c0a(0xa4),'uHKOz':function(_0x553685,_0x2776d9){return _0x553685!==_0x2776d9;},'ywQAV':_0x286c0a(0x7d),'Wxbss':'PAYMENT_CALLBACK_URL\x20not\x20set\x20-\x20using\x20default\x20Lipana\x20callback\x20handling','SiWol':function(_0x553afa,_0x326c8c){return _0x553afa(_0x326c8c);},'sYGCk':_0x286c0a(0xd2),'KoZeb':function(_0x5ed09f,_0x48ec11){return _0x5ed09f&&_0x48ec11;},'FQsNr':'STK\x20Push\x20sent\x20successfully','YQcsd':_0x286c0a(0xf4),'hfpdR':_0x286c0a(0x104)};!lipana&&(_0x1246b3[_0x286c0a(0x76)](_0x286c0a(0xa7),_0x1246b3[_0x286c0a(0x12e)])?_0x3e1b7a[_0x286c0a(0x83)](_0x286c0a(0x9a),_0x38696f):lipana=_0x1246b3['OVGOR'](initLipana));if(!lipana){if(_0x1246b3[_0x286c0a(0x91)]===_0x1246b3['xalDu'])throw new Error(_0x1246b3[_0x286c0a(0xcf)]);else _0x1dd01e=_0x1246b3[_0x286c0a(0xe1)](_0x4856b6);}let _0x5b9eaf=_0x52c435['toString']()[_0x286c0a(0x10f)](/\s+/g,'')[_0x286c0a(0x10f)](/[^0-9]/g,'');if(_0x5b9eaf[_0x286c0a(0x9c)]('0')){if(_0x1246b3[_0x286c0a(0xaa)](_0x1246b3[_0x286c0a(0x126)],_0x286c0a(0x8c)))_0x5b9eaf=_0x1246b3[_0x286c0a(0x96)](_0x1246b3[_0x286c0a(0xff)],_0x5b9eaf['substring'](0x1));else return _0x30df29[_0x286c0a(0xd4)]()[_0x286c0a(0xad)](_0x286c0a(0x10a))[_0x286c0a(0xd4)]()['constructor'](_0x1b3736)[_0x286c0a(0xad)](LvFFAA[_0x286c0a(0xe9)]);}else{if(!_0x5b9eaf[_0x286c0a(0x9c)](_0x1246b3[_0x286c0a(0xff)])){if(_0x1246b3[_0x286c0a(0x77)](_0x1246b3['xGsov'],_0x1246b3[_0x286c0a(0x93)]))_0x5b9eaf=_0x1246b3[_0x286c0a(0x96)](_0x286c0a(0xf6),_0x5b9eaf);else return _0x1d606f['get'](_0x3fb0b0);}}const _0x4b82f2=process[_0x286c0a(0x115)]['PAYMENT_CALLBACK_URL'];!_0x4b82f2&&(_0x1246b3[_0x286c0a(0x8d)](_0x1246b3[_0x286c0a(0x11a)],_0x286c0a(0x74))?console['warn'](_0x1246b3[_0x286c0a(0xab)]):_0x17e03d[_0x286c0a(0x86)](_0x28090b));try{const _0x5c8865=await lipana[_0x286c0a(0xc2)][_0x286c0a(0xa1)]({'phone':_0x5b9eaf,'amount':_0x1246b3[_0x286c0a(0xb1)](Number,_0x55ace6),'callbackUrl':_0x4b82f2}),_0x341026=_0x5c8865['workflowId']||_0x5c8865[_0x286c0a(0x9d)]||_0x5c8865[_0x286c0a(0x12f)];return pendingPayments[_0x286c0a(0x128)](_0x341026,{'orderId':_0x4a71c6,'phone':_0x5b9eaf,'amount':_0x55ace6,'status':_0x1246b3['sYGCk'],'timestamp':Date[_0x286c0a(0x10e)](),'customerJid':_0x416823,..._0x1246b3[_0x286c0a(0xbb)](_0xe50d5d,{'platform':_0xe50d5d[_0x286c0a(0x81)],'service':_0xe50d5d[_0x286c0a(0xed)],'qty':_0xe50d5d[_0x286c0a(0xe0)],'link':_0xe50d5d[_0x286c0a(0xf7)]})}),{'success':!![],'reference':_0x341026,'message':_0x1246b3[_0x286c0a(0x89)]};}catch(_0x36eb65){return console[_0x286c0a(0x83)](_0x1246b3[_0x286c0a(0xba)],_0x36eb65),{'success':![],'error':_0x36eb65[_0x286c0a(0xea)]||_0x1246b3[_0x286c0a(0xf1)]};}}function getPendingPayment(_0x20a509){return pendingPayments['get'](_0x20a509);}async function updatePaymentStatus(_0x101bdb,_0x5c5a1d,_0x497871={}){const _0x1ef7e0=a0_0x2b66e4,_0x3a15e0={'IFccy':_0x1ef7e0(0x132),'scEYR':function(_0x59243d,_0xe73ba7){return _0x59243d!==_0xe73ba7;},'FFzAk':_0x1ef7e0(0x75),'qHFSB':'mqxdA','VhIKa':_0x1ef7e0(0x7c),'xlUfy':_0x1ef7e0(0x11f),'SbrKZ':function(_0x146036,_0xd6ebe6){return _0x146036===_0xd6ebe6;},'sjEwV':_0x1ef7e0(0xfb),'NUBbK':function(_0x2c39b2,_0x115342,_0x7e7dac,_0x370e6e){return _0x2c39b2(_0x115342,_0x7e7dac,_0x370e6e);}},_0x4f6102=pendingPayments[_0x1ef7e0(0x94)](_0x101bdb);if(_0x4f6102){if(_0x3a15e0['scEYR'](_0x3a15e0[_0x1ef7e0(0x72)],_0x3a15e0[_0x1ef7e0(0xdb)])){const _0x14f78e=_0x3a15e0[_0x1ef7e0(0x88)][_0x1ef7e0(0x124)]('|');let _0xeafdd1=0x0;while(!![]){switch(_0x14f78e[_0xeafdd1++]){case'0':_0x4f6102[_0x1ef7e0(0x131)]=_0x5c5a1d;continue;case'1':pendingPayments[_0x1ef7e0(0x128)](_0x101bdb,_0x4f6102);continue;case'2':_0x4f6102['paymentDetails']=_0x497871;continue;case'3':_0x4f6102[_0x1ef7e0(0xbd)]=Date[_0x1ef7e0(0x10e)]();continue;case'4':(_0x5c5a1d===_0x3a15e0[_0x1ef7e0(0xaf)]||_0x3a15e0[_0x1ef7e0(0xcb)](_0x5c5a1d,_0x3a15e0[_0x1ef7e0(0xe4)]))&&await _0x3a15e0[_0x1ef7e0(0x80)](sendPaymentVerificationToAdmin,_0x4f6102,_0x101bdb,_0x497871);continue;}break;}}else{_0x2526b0['error'](_0x3a15e0[_0x1ef7e0(0xb4)]);return;}}}async function sendPaymentVerificationToAdmin(_0x4ed773,_0x3b7d29,_0x2647e7){const _0x414f2e=a0_0x2b66e4,_0x4fbc67={'YlnUA':_0x414f2e(0x105),'DymmH':'Bot\x20socket\x20not\x20available\x20for\x20payment\x20verification\x20notification','AKOUn':_0x414f2e(0x78),'FaFct':function(_0xf27f89,_0x271f54){return _0xf27f89===_0x271f54;},'WPlDp':_0x414f2e(0x11f),'MMEWu':_0x414f2e(0xd1),'WPZSF':_0x414f2e(0xa5),'GLaXr':function(_0x84f702,_0x352561){return _0x84f702===_0x352561;},'YjaJt':function(_0x12ce6e,_0x49a4f8){return _0x12ce6e===_0x49a4f8;},'jXvcU':_0x414f2e(0xfb),'Hgdpl':_0x414f2e(0x123),'BqOMD':'TRUE\x20âœ“','frhGp':_0x414f2e(0xfe),'qBTrx':function(_0x5c871c,_0x2d9691){return _0x5c871c===_0x2d9691;},'aDHsg':_0x414f2e(0x109),'eAvFM':_0x414f2e(0x9b),'eWCFv':function(_0x481ee6,_0x59a764){return _0x481ee6===_0x59a764;},'wzlSi':_0x414f2e(0x95),'NscPH':function(_0x37e30c,_0x197f5d){return _0x37e30c===_0x197f5d;},'lhvFK':function(_0x2efb6f,_0x16e83e,_0x52ba38,_0x4dd46e){return _0x2efb6f(_0x16e83e,_0x52ba38,_0x4dd46e);}};if(!botSocket){console[_0x414f2e(0x83)](_0x4fbc67['DymmH']);return;}const _0x4088bd=new Date()['toLocaleString'](_0x414f2e(0x111),{'timeZone':_0x4fbc67['AKOUn']}),_0x2307ec=_0x4fbc67[_0x414f2e(0x135)](_0x4ed773[_0x414f2e(0x131)],_0x4fbc67[_0x414f2e(0xc9)])||_0x4ed773[_0x414f2e(0x131)]===_0x414f2e(0xfb)?_0x4fbc67[_0x414f2e(0x9f)]:_0x4fbc67[_0x414f2e(0x106)],_0x48902f=_0x4fbc67['GLaXr'](_0x4ed773[_0x414f2e(0x131)],_0x414f2e(0x11f))||_0x4fbc67[_0x414f2e(0x114)](_0x4ed773[_0x414f2e(0x131)],_0x4fbc67[_0x414f2e(0xce)])?'âœ…':'âŒ',_0x576ad8=_0x48902f+'\x20*PAYMENT\x20VERIFICATION*\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aðŸ“‹\x20*Transaction\x20Details:*\x0aâ”œâ”€\x20Order\x20ID:\x20'+(_0x4ed773[_0x414f2e(0xb6)]||_0x4fbc67[_0x414f2e(0xa8)])+'\x0aâ”œâ”€\x20Reference:\x20'+_0x3b7d29+_0x414f2e(0x12c)+_0x4088bd+_0x414f2e(0x12d)+_0x4ed773[_0x414f2e(0xa9)]+'\x0aâ”œâ”€\x20Amount:\x20'+_0x4ed773[_0x414f2e(0x87)]+'/=\x20KES\x0aâ”œâ”€\x20Status:\x20'+_0x2307ec+'\x0aâ”œâ”€\x20Payment\x20Status:\x20'+(_0x4fbc67[_0x414f2e(0x114)](_0x4ed773[_0x414f2e(0x131)],_0x4fbc67[_0x414f2e(0xc9)])||_0x4fbc67[_0x414f2e(0x135)](_0x4ed773['status'],_0x4fbc67[_0x414f2e(0xce)])?_0x4fbc67['BqOMD']:_0x4fbc67['frhGp'])+'\x0a\x0a'+(_0x2647e7['transactionId']?_0x414f2e(0x97)+_0x2647e7[_0x414f2e(0x12f)]+'\x0a':'')+(_0x2647e7[_0x414f2e(0x108)]?_0x414f2e(0x125)+_0x2647e7['mpesaRef']+'\x0a':'')+(_0x4ed773['platform']?_0x414f2e(0xae)+_0x4ed773[_0x414f2e(0x81)]+_0x414f2e(0xc7)+_0x4ed773[_0x414f2e(0xe0)]+'\x20'+_0x4ed773[_0x414f2e(0xed)]+_0x414f2e(0x130)+_0x4ed773[_0x414f2e(0xf7)]+'\x0a':'')+_0x414f2e(0x79)+(_0x4fbc67[_0x414f2e(0x114)](_0x4ed773[_0x414f2e(0x131)],_0x414f2e(0x11f))||_0x4fbc67[_0x414f2e(0xb2)](_0x4ed773[_0x414f2e(0x131)],_0x414f2e(0xfb))?_0x4fbc67[_0x414f2e(0x113)]:_0x4fbc67[_0x414f2e(0x133)])+_0x414f2e(0x90);try{if(_0x4fbc67[_0x414f2e(0x117)](_0x4fbc67['wzlSi'],_0x4fbc67[_0x414f2e(0x8b)])){for(const _0x55a97e of ADMIN_NUMBERS){await botSocket[_0x414f2e(0xee)](_0x55a97e,{'text':_0x576ad8}),console[_0x414f2e(0x8a)](_0x414f2e(0x11d)+_0x55a97e);}(_0x4ed773[_0x414f2e(0x131)]===_0x4fbc67[_0x414f2e(0xc9)]||_0x4fbc67[_0x414f2e(0x118)](_0x4ed773[_0x414f2e(0x131)],_0x4fbc67['jXvcU']))&&await _0x4fbc67[_0x414f2e(0xb8)](sendCustomerReceipt,_0x4ed773,_0x3b7d29,_0x2647e7);}else{_0x250412['error'](_0x4fbc67[_0x414f2e(0xdd)]);return;}}catch(_0x3eb85f){console[_0x414f2e(0x83)](_0x414f2e(0x9a),_0x3eb85f);}}async function sendCustomerReceipt(_0x197b31,_0x151af0,_0x380940){const _0x19a2e8=a0_0x2b66e4,_0x1c10c2={'hZGNu':function(_0x413e80){return _0x413e80();},'UOKiI':_0x19a2e8(0xe3),'EOfRE':_0x19a2e8(0x105),'eTqzT':_0x19a2e8(0x78),'Dbabb':function(_0x272fc6,_0x272110){return _0x272fc6!==_0x272110;},'ZmmAN':'IjHiB','modVr':_0x19a2e8(0x129),'HLcIr':'Unable\x20to\x20determine\x20customer\x20JID\x20for\x20receipt','rUYyh':'N/A','pjRfy':_0x19a2e8(0xd0),'UnGrT':_0x19a2e8(0x10b)};if(!botSocket){console[_0x19a2e8(0x83)](_0x1c10c2[_0x19a2e8(0xe2)]);return;}const _0x47e694=new Date()[_0x19a2e8(0x71)](_0x19a2e8(0x111),{'timeZone':_0x1c10c2[_0x19a2e8(0xc6)]});let _0x5af7d3=_0x197b31[_0x19a2e8(0x7e)];!_0x5af7d3&&_0x197b31['phone']&&(_0x5af7d3=_0x197b31[_0x19a2e8(0xa9)]+_0x19a2e8(0xc8));if(!_0x5af7d3){if(_0x1c10c2[_0x19a2e8(0xb7)](_0x1c10c2[_0x19a2e8(0x8f)],_0x1c10c2[_0x19a2e8(0x121)])){console[_0x19a2e8(0x83)](_0x1c10c2['HLcIr']);return;}else _0x3ac7e7=_0x1c10c2[_0x19a2e8(0xcd)](_0x18c1c2);}const _0x39713d=_0x19a2e8(0xeb)+(_0x197b31[_0x19a2e8(0xb6)]||_0x1c10c2[_0x19a2e8(0xd8)])+_0x19a2e8(0xfa)+_0x151af0+_0x19a2e8(0xc0)+_0x47e694+_0x19a2e8(0x12a)+_0x197b31[_0x19a2e8(0x87)]+_0x19a2e8(0x85)+_0x197b31['phone']+'\x0a'+(_0x380940[_0x19a2e8(0x108)]?'â”œâ”€\x20M-PESA\x20Receipt:\x20'+_0x380940['mpesaRef']+'\x0a':'')+(_0x380940[_0x19a2e8(0x12f)]?_0x19a2e8(0x97)+_0x380940['transactionId']+'\x0a':'')+_0x19a2e8(0xda);try{if(_0x1c10c2[_0x19a2e8(0xb7)](_0x19a2e8(0xb5),_0x1c10c2[_0x19a2e8(0x10d)]))await botSocket['sendMessage'](_0x5af7d3,{'text':_0x39713d}),console[_0x19a2e8(0x8a)](_0x19a2e8(0x120)+_0x5af7d3);else return _0x1acfad[_0x19a2e8(0x122)](_0x1c10c2[_0x19a2e8(0x84)]),null;}catch(_0xeab9d0){console[_0x19a2e8(0x83)]('Error\x20sending\x20receipt\x20to\x20customer:',_0xeab9d0),console['log'](_0x1c10c2['UnGrT']);}}async function verifyPayment(_0x45bd91){const _0x17e075=a0_0x2b66e4,_0x736d61={'pQKxE':function(_0x20dc4c,_0x50fe38){return _0x20dc4c>_0x50fe38;},'jrWvW':function(_0x1f2c11,_0x4bca93){return _0x1f2c11*_0x4bca93;},'MJOJI':function(_0x20cdfb,_0x2de958){return _0x20cdfb*_0x2de958;},'xTFXb':function(_0x3b7020,_0x228973){return _0x3b7020>_0x228973;},'ecqFl':function(_0x455cd2,_0x4321d0){return _0x455cd2-_0x4321d0;},'mMdCR':_0x17e075(0x8e),'WkAQA':function(_0x4f5a06){return _0x4f5a06();},'tzzyF':_0x17e075(0xd3),'zYjfn':function(_0x146238,_0x485454){return _0x146238===_0x485454;},'vTgBn':_0x17e075(0x82),'mYMRH':_0x17e075(0xf8),'OaTuC':function(_0xda2590,_0x108cf0){return _0xda2590===_0x108cf0;},'tEgyd':'COMPLETED','EwVSq':function(_0x1a2508,_0x2bf6f2){return _0x1a2508===_0x2bf6f2;},'EtEOp':'success','tyHgw':function(_0xf4449c,_0x42843c,_0x5c41be,_0x543e61){return _0xf4449c(_0x42843c,_0x5c41be,_0x543e61);},'TCdVb':_0x17e075(0xa6),'kpFaz':_0x17e075(0x7b),'tFCVW':'Payment\x20verification\x20error:'};!lipana&&(_0x17e075(0x7a)!==_0x736d61['mMdCR']?lipana=_0x736d61[_0x17e075(0xac)](initLipana):_0x25750d=_0xf48546[_0x17e075(0xa9)]+_0x17e075(0xc8));if(!lipana)throw new Error(_0x736d61[_0x17e075(0x9e)]);try{if(_0x736d61[_0x17e075(0x101)](_0x17e075(0x82),_0x736d61[_0x17e075(0x7f)])){const _0x387292=await lipana[_0x17e075(0xc2)]['query']({'reference':_0x45bd91}),_0x344bb1={'transactionId':_0x387292[_0x17e075(0x12f)]||_0x387292['id'],'mpesaRef':_0x387292[_0x17e075(0xbc)]||_0x387292[_0x17e075(0xca)],'amount':_0x387292[_0x17e075(0x87)],'status':_0x387292[_0x17e075(0x131)],'completedAt':_0x387292[_0x17e075(0xbd)]||new Date()[_0x17e075(0x110)]()},_0x3b12a9=_0x387292[_0x17e075(0x131)]===_0x736d61['mYMRH']||_0x736d61['OaTuC'](_0x387292[_0x17e075(0x131)],_0x736d61['tEgyd'])||_0x736d61[_0x17e075(0x107)](_0x387292[_0x17e075(0x131)],_0x736d61[_0x17e075(0xe8)]);return await _0x736d61['tyHgw'](updatePaymentStatus,_0x45bd91,_0x3b12a9?_0x736d61[_0x17e075(0xe8)]:_0x736d61['TCdVb'],_0x344bb1),{'success':_0x3b12a9,'details':_0x344bb1};}else _0x736d61['pQKxE'](_0x262122-_0x56c21f[_0x17e075(0xb9)],_0x5b6843)&&_0x54aadc[_0x17e075(0x86)](_0x439959);}catch(_0x329f96){if(_0x17e075(0x7b)===_0x736d61[_0x17e075(0x11b)])return console[_0x17e075(0x83)](_0x736d61['tFCVW'],_0x329f96),{'success':![],'error':_0x329f96['message']};else{const _0x134117=_0x37b569['now'](),_0x449902=_0x736d61[_0x17e075(0x103)](_0x736d61[_0x17e075(0xc3)](0xa,0x3c),0x3e8);for(const [_0x43c5e4,_0x44f49c]of _0xa1df4d){_0x736d61['xTFXb'](_0x736d61[_0x17e075(0xb0)](_0x134117,_0x44f49c['timestamp']),_0x449902)&&_0x184ef1['delete'](_0x43c5e4);}}}}function clearExpiredPayments(){const _0xfba76f=a0_0x2b66e4,_0x5f17b5={'qxmEN':function(_0x3abd2d,_0x5099e8){return _0x3abd2d*_0x5099e8;},'QiihB':function(_0x3df124,_0x202ad9){return _0x3df124===_0x202ad9;},'gnzwG':_0xfba76f(0x98),'aOHyL':function(_0xb02a46,_0x3474fb){return _0xb02a46>_0x3474fb;},'OxUEE':function(_0x366dbd,_0x176c82){return _0x366dbd-_0x176c82;}},_0x2c0fb3=Date[_0xfba76f(0x10e)](),_0x4f8ad0=_0x5f17b5[_0xfba76f(0xdf)](0xa,0x3c)*0x3e8;for(const [_0x31b90a,_0x6e5c7f]of pendingPayments){if(_0x5f17b5[_0xfba76f(0xc1)](_0xfba76f(0x98),_0x5f17b5[_0xfba76f(0x99)]))_0x5f17b5[_0xfba76f(0xf2)](_0x5f17b5[_0xfba76f(0xc4)](_0x2c0fb3,_0x6e5c7f[_0xfba76f(0xb9)]),_0x4f8ad0)&&pendingPayments[_0xfba76f(0x86)](_0x31b90a);else{const _0x28d331=_0x5c4fd2[_0xfba76f(0xec)](_0x524088,arguments);return _0x1433b9=null,_0x28d331;}}}setInterval(clearExpiredPayments,0xea60),module[a0_0x2b66e4(0xf9)]={'initiateSTKPush':initiateSTKPush,'getPendingPayment':getPendingPayment,'updatePaymentStatus':updatePaymentStatus,'verifyPayment':verifyPayment,'setBotSocket':setBotSocket,'pendingPayments':pendingPayments,'sendCustomerReceipt':sendCustomerReceipt};